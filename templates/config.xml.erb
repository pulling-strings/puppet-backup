<configuration version="7">
  <% @repos.each_pair do |repo, props| -%>
  <folder id="<%=repo%>" path="<%=props['directory']%>" ro="<%=props['ro']%>" rescanIntervalS="60" ignorePerms="false">
    <% props['nodes'].each do |id| -%>
      <device id="<%=id%>"></device>
    <% end -%>
    <versioning></versioning>
    <lenientMtimes>false</lenientMtimes>
    <copiers>1</copiers>
    <pullers>16</pullers>
    <hashers>0</hashers>
  </folder>
  <% end -%>

  <% @nodes.each_pair do |id, props|-%>
  <device id="<%=id%>" name="<%=props['name']%>">
    <address><%=props['address']%></address>
  </device>
  <% end -%>

  <gui enabled="true" tls="true">
    <address>0.0.0.0:8080</address>
    <user><%=@user%></user>
    <password><%=@password%></password>
    <apikey><%=@token%></apikey>
  </gui>

  <options>
     <listenAddress>0.0.0.0:22000</listenAddress>
     <globalAnnounceServer>udp4://announce.syncthing.net:22026</globalAnnounceServer>
     <globalAnnounceEnabled>false</globalAnnounceEnabled>
     <localAnnounceEnabled>true</localAnnounceEnabled>
     <localAnnouncePort>21025</localAnnouncePort>
     <localAnnounceMCAddr>[ff32::5222]:21026</localAnnounceMCAddr>
     <maxSendKbps>0</maxSendKbps>    
     <maxRecvKbps>0</maxRecvKbps>
     <reconnectionIntervalS>60</reconnectionIntervalS>
     <startBrowser>true</startBrowser>
     <upnpEnabled>false</upnpEnabled>
     <upnpLeaseMinutes>0</upnpLeaseMinutes>
     <upnpRenewalMinutes>30</upnpRenewalMinutes>
     <urAccepted>-1</urAccepted>     
     <urUniqueID></urUniqueID>
     <restartOnWakeup>true</restartOnWakeup>
     <autoUpgradeIntervalH>12</autoUpgradeIntervalH>
     <keepTemporariesH>24</keepTemporariesH>
     <cacheIgnoredFiles>true</cacheIgnoredFiles>
     <progressUpdateIntervalS>5</progressUpdateIntervalS>
     <symlinksEnabled>true</symlinksEnabled>
  </options>

</configuration>
